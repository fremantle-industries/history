<div class="space-x-4">
  <%= render HistoryWeb.DataView, "_header.html", conn: @socket, section: [{"Candles", Routes.candle_path(@socket, :index)}, "Latest"] %>
</div>
<%= render HistoryWeb.DataView, "_nav.html", conn: @socket %>

<div class="mt-8">
  <h3 class="text-2xl">
    Latest
  </h3>

  <form phx-change="suggest" phx-submit="search" class="mt-4">
    <input type="text" name="q" value="<%= @query %>" placeholder="Search" autocomplete="off"/>
  </form>

  <%= form_for @changeset, "#", [phx_submit: :save, class: "mt-8"], fn _f -> %>
    <table class="w-full mt-4">
      <thead class="bg-gray-200 border-t-2 border-gray-400">
        <tr>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Time</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Period</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Venue</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Product</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Open</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">High</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Low</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Close</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Volume</th>
          <th scope="col" class="px-4 py-3 text-left text-gray-700">Source</th>
          <th scope="col" class="px-4 py-3 text-right text-gray-700">Actions</th>
        </tr>
      </thead>
      <tbody>
        <%= if Enum.any?(@candles) do %>
          <%= for c <- @candles do %>
            <tr class="hover:bg-gray-50 border-t border-b group">
              <td class="px-4 py-3"><%= c.time %></td>
              <td class="px-4 py-3"><%= c.period %></td>
              <td class="px-4 py-3"><%= c.venue %></td>
              <td class="px-4 py-3"><%= c.product %></td>
              <td class="px-4 py-3"><%= c.open %></td>
              <td class="px-4 py-3"><%= c.high %></td>
              <td class="px-4 py-3"><%= c.low %></td>
              <td class="px-4 py-3"><%= c.close %></td>
              <td class="px-4 py-3"><%= c.volume %></td>
              <td class="px-4 py-3"><%= c.source %></td>
              <td class="px-4 py-3 text-right">
                <button
                  type="button"
                  class="text-red-500 opacity-75 hover:opacity-100 invisible group-hover:visible"
                  phx-click="delete"
                  phx-value-candle-id="<%= c.id %>"
                >
                  Delete
                </button>
              </td>
            </tr>
          <% end %>
        <% else %>
          <tr class="hover:bg-gray-50 border-t border-b group">
            <td colspan="11" class="px-4 py-3">No candles</td>
          </tr>
        <% end %>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="11" class="px-4 py-3 text-right">
            <%= link "<<", to: Routes.candle_latest_path(@socket, :index, page: @first_page), class: "border px-4 py-2 bg-gray-100 opacity-70 hover:opacity-50" %>
            <%= link "<", to: Routes.candle_latest_path(@socket, :index, page: @previous_page), class: "border px-4 py-2 bg-gray-100 opacity-70 hover:opacity-50" %>
            <%= link @current_page, to: Routes.candle_latest_path(@socket, :index, page: @current_page), class: "border px-4 py-2 bg-gray-100 opacity-70 hover:opacity-50" %>
            <%= link ">", to: Routes.candle_latest_path(@socket, :index, page: @next_page), class: "border px-4 py-2 bg-gray-100 opacity-70 hover:opacity-50" %>
            <%= link ">>", to: Routes.candle_latest_path(@socket, :index, page: @last_page), class: "border px-4 py-2 bg-gray-100 opacity-70 hover:opacity-50" %>
          </td>
        </tr>
      </tfoot>
    </table>
  <% end %>
</div>
